# 模块系统的说明

该文章是关于在[JSR 376: The Java Platform Module System](http://openjdk.java.net/projects/jigsaw/spec/)中提议的[Jigsaw](http://openjdk.java.net/projects/jigsaw/)项目原型的非正式版概览。[另一篇文章](http://openjdk.java.net/jeps/261)文章文章描述了JDK相关工具以及API的一些增强特性，不过这不在JSR的范围之内了。

就像[JSR376](http://openjdk.java.net/projects/jigsaw/spec/)中描述的一样，模块化系统的目标是提供：  

* 可靠的配置，用程序组件的方式来替代那脆弱的、易出错的classpath机制，并且可以显示的声明对其他组件的依赖。
* 强封装，允许组件声明哪些类型可以对其它组件开放，哪些不可以。

这些特性将会为应用开发者，库开发者，以及Java SE平台的实现人员带来直接跟间接的好处，因为开发者们可以使得系统具有更好的拓展性，更高的完整性，以及更高的性能。

### 目录

### 1. [定义模块](#1)  
[模块声明](#1.1).[模块组件](#1.2).[模块描述符](#1.3)
### 2. [使用模块](#2)  
[模块路径](#2.1).[解析](#2.2).[可读性](#2.3).[可访问性](#2.4).[隐式可读性](#2.5)
### 3. [兼容性&迁移](#3)
[未命名的模块](#3.1).[自底向上的迁移](#3.2).[自动化模块](#3.3).[类路径的桥接](#3.4)
### 4. [服务](#4)
### 5. [高级话题](#5)
[映射](#5.1).[映射可读性](#5.2).[类加载器](#5.3).[未命名的模块](#5.4).[层](#5.5).[有限制的导出](#5.5)
### [总结](#6)
### [致谢](#7)

这是该文档的第二版，相比[最初版](http://openjdk.java.net/projects/jigsaw/spec/sotms/2015-09-08)，该版本介绍了[兼容性与迁移]()，修改了[映射可读性]()，重新编排文字，已改善叙述流程，并且分了两级以便于导航阅读。
目前的设计中依旧有很多[问题](http://openjdk.java.net/projects/jigsaw/spec/issues/)，他们的解决方案将会在该文档的未来版本中给予说明。

### <a name="1"></a>1 定义模块

#### <a name="1.1"></a>1.1 模块声明 

一个模块的自描述性很好的体现在了它的`模块声明`上，一种Java编程语言中定义的新结构。一个可能的最简单的模块定义差不多只需要指定模块的名字即可：

```

module com.foo.bar { }  


```  
可以定义一个或多个`requires`语句来指定该模块在编译期以及运行时所依赖的其他模块的名字： 

```
module com.foo.bar {
    requires org.baz.qux;
}
```
最后，`exports`语句用来声明指定的包中的所有的，并且只有，`public`类型对其他模块可见：

```
module com.foo.bar {
    requires org.baz.qux;
    exports com.foo.bar.alpha;
    exports com.foo.bar.beta;
}
```
如果一个模块的声明中，不包含`exports`语句，则表明该模块不会对其他模块公开任何类型。  
按照约定，源码的模块定义被放在一个名为`module-info.java`的文件中，该文件位于源码层次结构的更目录下。com.foo.bar模块的源文件如下：

```
module-info.java
com/foo/bar/alpha/AlphaFactory.java
com/foo/bar/alpha/Alpha.java
...
```
按照约定，模块定义被编译到`module-info.class`文件中，同样会被放到类文件的输出目录中去。  
模块名称，就像包名称，必须不能有冲突。就像我们一直推荐的包取名的模式一样，我们推荐使用翻转域名的模式来给模块取名字。因此，通常模块的名字是导出包的名字的前缀，不过这种关系并不是强制性的。  
一个模块的定义不包含版本字符串，也不包含它所依赖的其他模块的版本号，这是有意为之的：解决版本选择问题并不是模块系统的[一个目标](http://openjdk.java.net/projects/jigsaw/spec/reqs/02#version-selection)，我们更倾向于将它留给构建工具或者容器来解决。  
由于一些原因，模块声明是Java编程语言的一部分，而不是一门自成体系的语言或符号，其中最重要的就是模块信息在编译期和运行时必须都可用，以达到跨阶段的高保真度，例如，确保模块系统在编译期跟运行时能以相同的方式工作，相应的，这就可以避免一些错误，或者至少能更早的报告错误--在编译期--可以更早的诊断然后修复。  
将源文件中的模块声明与模块中的其他源文件一起转换为Java虚拟机所需的类文件是建立保真度的一种常规手段。这种方式对于开发人员相当熟悉，并且对于IDE或者构建工具的支持也不困难。尤其是IDE，可以通过requires从组件的项目描述中已经提供的信息合成子句来为现有组件提供初始模块声明的建议。

#### <a name="1.2"></a>1.2 模块组件
#### <a name="1.3"></a>1.3 模块描述

### <a name="2"></a>2 使用模块
#### <a name="2.1"></a>2.1 模块路径
#### <a name="2.1"></a>2.2 解析
#### <a name="2.1"></a>2.3 可读性
#### <a name="2.1"></a>2.4 可访问性
#### <a name="2.1"></a>2.5 隐式可读性


### <a name="3"></a>3 兼容性&迁移
#### <a name="3.1"></a>3.1 未命名的模块
#### <a name="3.2"></a>3.2 自底向上的迁移
#### <a name="3.3"></a>3.3 自动化模块
#### <a name="3.4"></a>3.4 类路径桥接

### <a name="4"></a>4 服务

### <a name="5"></a>5 高级话题
#### <a name="5.1"></a>5.1 映射
#### <a name="5.2"></a>5.2 映射可读性

### <a name="6"></a>6 总结

### <a name="7"></a>7 致谢
